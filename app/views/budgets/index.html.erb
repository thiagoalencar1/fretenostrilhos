<h1 class="text-center">Orçamento</h1>
<br />
<div class="m-auto" style="max-width: 400px">
  <%= form_with url: budgets_path, method: :get do |budget| %>
    <div class="mb-3">
      <%= budget.label :volume, 'Volume', class: 'col-sm-2 col-form-label'%>
      <%= budget.number_field :volume %>
    </div>

    <div class="mb-3">
      <%= budget.label :weight, 'Peso', class: 'col-sm-2 col-form-label' %>
      <%= budget.number_field :weight %>
    </div>

    <div class="mb-3">
      <%= budget.label :distance, 'Distância', class: 'col-sm-2 col-form-label'%>
      <%= budget.number_field :distance %>
    </div>

    <div class="text-center" style="margin-top: 20px;">
      <%= budget.submit 'Consultar', class: 'btn btn-primary' %>
    </div>
  <% end %>
</div>

<hr >

<% if @carriers.empty? %>
  <div>Nenhuma transportadora encontrada.</div>
<% else %>
  <% if params[:volume].present? && params[:distance].present? && params[:weight].present? %>
  <h3 class="text-center">Resultado de Orçamento por Transportadora</h3>
  <table class="table text-center align-middle">
    <thead>
      <tr>
        <th>Transportadora</th>
        <th>Valor estimado</th>
        <th>Prazo</th>
        <th>Ação</th>
      </tr>
    </thead>
    <tbody>
      <% @carriers.each do |carrier| %>
      <tr>
        <td><%= carrier.brand_name %></td>
        <td>R$ <%= carrier.total_order_value(params[:volume].to_i, params[:distance].to_i, params[:distance].to_i) %></td>
        <td><%= carrier.estimated_delivery_date(params[:distance].to_i) %> dias</td>
        <td><%= link_to "Abrir ordem na #{carrier.brand_name}.", new_order_path, class: 'btn btn-outline-warning' %></td>
      </tr>
      <% end %>
  </table>
  <% end %>
<% end %>